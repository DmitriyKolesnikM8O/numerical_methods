import numpy as np
import matplotlib.pyplot as plt

# --- 1. ДАННЫЕ ИЗ ВЫВОДА ТВОЕЙ C++ ПРОГРАММЫ ---
# ... (блок данных остается без изменений, я его сверну)
x_k = np.array([0.0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0])
y_exact = np.array([0.5, 0.58019173, 0.67156876, 0.77541629, 0.89313704, 1.02626194, 1.17646249, 1.34556494, 1.53556645, 1.74865361, 1.98722325])
y_shooting = np.array([0.50000647, 0.58019804, 0.6715749, 0.77542225, 0.89314281, 1.02626752, 1.17646787, 1.34557009, 1.53557137, 1.74865828, 1.98722764])
y_finite_diff = np.array([0.49905088, 0.5790485, 0.67021675, 0.77383888, 0.89131528, 1.02417413, 1.17408372, 1.34286651, 1.53251537, 1.74521193, 1.98334739])
final_errors = {
    'Метод стрельбы': {'rr': 5.8e-06, 'true_max': 6.47e-06},
    'Конечно-разностный метод': {'rr': 0.00384302, 'true_max': 0.00387586}
}


# --- 2. НАСТРОЙКА СТИЛЯ ГРАФИКОВ ---
plt.style.use('seaborn-v0_8-whitegrid')
plt.rcParams['font.size'] = 12

# --- 3. ПОСТРОЕНИЕ ГРАФИКОВ ---

# == ГРАФИК 1: Основное сравнение (остается для общего вида) ==
# ... (код без изменений)

# == ГРАФИК 2: Абсолютные погрешности (остается для анализа) ==
# ... (код без изменений)

# == ГРАФИК 3: Сравнение оценок Рунге-Ромберга (остается для анализа) ==
# ... (код без изменений)

# == НОВЫЙ ГРАФИК 4: "УВЕЛИЧЕННЫЙ" - График отклонений от метода стрельбы ==
fig4, ax4 = plt.subplots(figsize=(12, 8))

# Базовая линия (сам метод стрельбы) будет на нуле
ax4.axhline(0, color='blue', linestyle='--', label='Метод стрельбы (базовая линия)')

# Отклонение точного решения от метода стрельбы
error_exact_vs_shooting = y_exact - y_shooting
ax4.plot(x_k, error_exact_vs_shooting, 'o-', color='black', label='Отклонение точного решения')

# Отклонение конечно-разностного метода от метода стрельбы
error_fd_vs_shooting = y_finite_diff - y_shooting
ax4.plot(x_k, error_fd_vs_shooting, 's-', color='red', label='Отклонение конечно-разностного метода')

ax4.set_title('График отклонений от решения Методом стрельбы ("под микроскопом")', fontsize=16)
ax4.set_xlabel('x', fontsize=12)
ax4.set_ylabel('Разница, y(x) - y_стрельбы(x)', fontsize=12)
ax4.legend()
ax4.grid(True, which='both')

# Показываем все созданные графики
plt.tight_layout()
plt.show()